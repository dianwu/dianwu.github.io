<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<title>service worker test</title>
<link rel="manifest" href="/manifest.json">
</head>
<body>
    <button onclick="subscribe()" >subscribe</button>
    hello world
</body>
<script type="text/javascript">
if ('serviceWorker' in navigator) {
 console.log('Service Worker is supported');
 navigator.serviceWorker.register('service_worker.js').then(function(reg) {
   console.log(':^)', reg);
   // TODO
 }).catch(function(err) {
   console.log(':^(', err);
 });
 
 
     
}

// ----------------------------------- 
// Dian copy form google 
function subscribe(){
  navigator.serviceWorker.ready.then(function(serviceWorkerRegistration) {  
    serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:true})
    .then(function(subscription) {
        var endpoint = subscription.endpoint;
        var endpointParts = endpoint.split('/');
        var registrationId = endpointParts.pop();
        console.log('registrationId',registrationId);
        // return sendSubscriptionToServer(subscription);  
      }) 
  });
}
</script>
</html>
